<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-smartcard/DoD-SmartCard-Admins" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.8.1">
<title data-rh="true">DoD | Admin | CAC For Mac</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://cacformac.com/img/Example_CAC.png"><meta data-rh="true" name="twitter:image" content="https://cacformac.com/img/Example_CAC.png"><meta data-rh="true" property="og:url" content="https://cacformac.com/docs/smartcard/DoD-SmartCard-Admins"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="DoD | Admin | CAC For Mac"><meta data-rh="true" name="description" content="This guide provides step-by-step instructions for system administrators on enforcing Common Access Card (CAC) authentication on MDM-managed devices for DoD employees. Due to current Apple platform limitations, full CAC enforcement (including keychain access and system updates) is not yet possible. However, with the right configuration, you can achieve up to 90% CAC enforcement for most workflows."><meta data-rh="true" property="og:description" content="This guide provides step-by-step instructions for system administrators on enforcing Common Access Card (CAC) authentication on MDM-managed devices for DoD employees. Due to current Apple platform limitations, full CAC enforcement (including keychain access and system updates) is not yet possible. However, with the right configuration, you can achieve up to 90% CAC enforcement for most workflows."><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://cacformac.com/docs/smartcard/DoD-SmartCard-Admins"><link data-rh="true" rel="alternate" href="https://cacformac.com/docs/smartcard/DoD-SmartCard-Admins" hreflang="en"><link data-rh="true" rel="alternate" href="https://cacformac.com/docs/smartcard/DoD-SmartCard-Admins" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"DoD | Admin","item":"https://cacformac.com/docs/smartcard/DoD-SmartCard-Admins"}]}</script><link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-3BYEB7MXSW"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-3BYEB7MXSW",{})</script><link rel="stylesheet" href="/assets/css/styles.d97873ca.css">
<script src="/assets/js/runtime~main.acd5cbf4.js" defer="defer"></script>
<script src="/assets/js/main.e0a4b893.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t="light";var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",e||t),document.documentElement.setAttribute("data-theme-choice",e||t)}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())</script><div id="__docusaurus"><link rel="preload" as="image" href="/img/logo.svg"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><div class="theme-announcement-bar announcementBar_mb4j" style="background-color:#2563eb;color:#ffffff" role="banner"><div class="announcementBarPlaceholder_vyr4"></div><div class="content_knG7 announcementBarContent_xLdY"><b>🚀 Looking for people to <a target="_blank" rel="noopener noreferrer" href="https://github.com/cocopuff2u/CAC_FOR_MAC">contribute</a>! Join us and help improve CAC For Mac.</b></div><button type="button" aria-label="Close" class="clean-btn close closeButton_CVFx announcementBarClose_gvF7"><svg viewBox="0 0 15 15" width="14" height="14"><g stroke="currentColor" stroke-width="3.1"><path d="M.75.75l13.5 13.5M14.25.75L.75 14.25"></path></g></svg></button></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="CAC For Mac Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo.svg" alt="CAC For Mac Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">CAC For Mac</b></a><a class="navbar__item navbar__link" href="/docs/intro">Introduction</a><a class="navbar__item navbar__link" href="/docs/certificate/Certificate-Introduction">Certificate Guide</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/smartcard/Smart-Card-Introduction">Smart Card Guide</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/support">Support</a><a class="navbar__item navbar__link" href="/about">About</a><a href="https://github.com/cocopuff2u/CAC_FOR_MAC" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="GitHub repository"></a><a href="https://www.buymeacoffee.com/cocopuff2u" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-buymeacoffee-link" aria-label="Buy Me a Coffee"></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG menuWithAnnouncementBar_GW3s"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/smartcard/Smart-Card-Introduction">Smart Card Introduction</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/smartcard/Any-SmartCard-Users">General | User</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/smartcard/Any-SmartCard-Admins">General | Admin</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/smartcard/DoD-SmartCard-Users">DoD | User</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" href="/docs/smartcard/DoD-SmartCard-Admins">DoD | Admin</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/smartcard/SmartCard-Settings">SmartCard Settings</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/smartcard/Tools-Apps">Tools &amp; Apps</a></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">DoD | Admin</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>DoD CAC Setup – Admin Guide</h1></header>
<p>This guide provides step-by-step instructions for system administrators on enforcing Common Access Card (CAC) authentication on MDM-managed devices for DoD employees. Due to current Apple platform limitations, full CAC enforcement (including keychain access and system updates) is not yet possible. However, with the right configuration, you can achieve up to 90% CAC enforcement for most workflows.</p>
<p><strong>Important Recommendations:</strong></p>
<ul>
<li><strong>Deploy DoD Certificates First:</strong> Before enforcing any smart card policies, ensure that DoD certificates are deployed to the device. Follow the <a href="/docs/certificate/DoD-Certificates-Admins">DoD Certificates Admin Guide</a> for details.</li>
<li><strong>Establish a Smart Card Pairing Workflow:</strong> Before enabling enforcement, set up a workflow for users to pair their smart card with their account. If enforcement is enabled without pairing, users will be locked out of their devices.</li>
</ul>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>Recommended</div><div class="admonitionContent_BuS1"><p>For maximum security and scalability, devices should be managed with a Mobile Device Management (MDM) system. The best practice for deploying DoD CAC enforcement is to use MDM to push a configuration profile (<code>.mobileconfig</code> file) with the required settings to your entire fleet.</p><p>If your organization does <strong>not</strong> use MDM, enforcing CAC is not recommended. In this case, refer to the DoD User Guide for alternative approaches.</p></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="cac-workflow"><strong>CAC Workflow</strong><a href="#cac-workflow" class="hash-link" aria-label="Direct link to cac-workflow" title="Direct link to cac-workflow">​</a></h2>
<ol>
<li><strong>Deploy DoD Certificates to Device:</strong> Use MDM to push required DoD certificates.</li>
<li><strong>Guide Users Through Forced Pairing:</strong> Require users to pair their smart card with their account before proceeding. This can be enforced via MDM or onboarding scripts.</li>
<li><strong>Verify Pairing Success:</strong> Confirm that the smart card is correctly paired to the user account.</li>
<li><strong>(Optional) Exempt Admin Account or Unenforce for Troubleshooting:</strong> Consider maintaining an exempt admin account or a workflow to temporarily disable enforcement for troubleshooting purposes.</li>
<li><strong>Enforce Smart Card Policies:</strong> Once pairing is verified, enable CAC enforcement via MDM.</li>
<li><strong>Update PAM Configuration:</strong> After smart card enforcement is enabled, update your PAM (Pluggable Authentication Modules) configuration files to support CAC authentication for additional system functions as needed.</li>
</ol>
<p>Here&#x27;s a revised and more polished version of your text for clarity, professionalism, and improved flow:</p>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="cac-pairing"><strong>CAC Pairing</strong><a href="#cac-pairing" class="hash-link" aria-label="Direct link to cac-pairing" title="Direct link to cac-pairing">​</a></h2>
<p>Before enforcing CAC (Common Access Card) authentication, it&#x27;s important to establish a workflow for pairing the CAC with the user&#x27;s account. There are two primary methods for doing this:</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="pair-piv-id-preferred-method">Pair PIV ID <small><em>(Preferred Method)</em></small><a href="#pair-piv-id-preferred-method" class="hash-link" aria-label="Direct link to pair-piv-id-preferred-method" title="Direct link to pair-piv-id-preferred-method">​</a></h3>
<p>This method links the PIV (Personal Identity Verification) identifier from the CAC to the <code>AltSecurityIdentities</code> attribute on the user&#x27;s account.</p>
<p><strong>Advantages:</strong></p>
<ul>
<li>Seamlessly supports multiple CACs or switching between them.</li>
<li>Typically requires no re-pairing unless the user transitions between roles (e.g., from contractor to civilian), as the PIV ID usually remains consistent across CACs.</li>
</ul>
<p><strong>Considerations:</strong></p>
<ul>
<li>May still function even if the certificate has expired <small><em>(unverified)</em></small>.</li>
<li>If the PIV ID changes (e.g., due to role transition and a new CAC being issued), re-pairing is required, including uninstall and reinstall.</li>
</ul>
<p><strong>Automation Scripts:</strong>
The following scripts can streamline the PIV pairing process:</p>
<ul>
<li>
<p><a href="https://github.com/cocopuff2u/CAC_FOR_MAC/blob/main/scripts/SmartCard_Mapping_With_Exempt.sh" target="_blank" rel="noopener noreferrer"><strong>SmartCard Mapping with Exempt Accounts</strong></a></p>
<ul>
<li>Pairs the PIV ID with the account</li>
<li>Optionally creates exempt accounts</li>
<li>Optionally includes Trusted Authorities</li>
<li>Generates the required <code>smartcardlogin.plist</code> file</li>
</ul>
</li>
<li>
<p><a href="https://github.com/cocopuff2u/CAC_FOR_MAC/blob/main/scripts/SmartCard_Mapping.sh" target="_blank" rel="noopener noreferrer"><strong>SmartCard Mapping</strong></a></p>
<ul>
<li>Pairs the PIV ID with the account</li>
<li>Optionally includes Trusted Authorities</li>
<li>Generates the required <code>smartcardlogin.plist</code> file</li>
</ul>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="built-in-pairing">Built-In Pairing<a href="#built-in-pairing" class="hash-link" aria-label="Direct link to Built-In Pairing" title="Direct link to Built-In Pairing">​</a></h3>
<p>This method uses Apple&#x27;s native pairing tool to associate CAC certificates directly with the local account.</p>
<p><strong>Advantages:</strong></p>
<ul>
<li>Automatically prompts for authentication when the CAC is inserted</li>
<li>Pairing is certificate-based, and will stop working if the certificates expire <small><em>(unverified)</em></small></li>
</ul>
<p><strong>Considerations:</strong></p>
<ul>
<li>Requires manual re-pairing if the CAC is replaced</li>
<li>Only one CAC can be paired at a time</li>
<li>Recommended to clear any existing pairings before re-pairing</li>
</ul>
<blockquote>
<p>⚠️ <em>This method cannot be automated and must be performed manually by the user.</em></p>
</blockquote>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="cac-enforcement"><strong>CAC Enforcement</strong><a href="#cac-enforcement" class="hash-link" aria-label="Direct link to cac-enforcement" title="Direct link to cac-enforcement">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="step-1-prerequisites">Step 1: Prerequisites<a href="#step-1-prerequisites" class="hash-link" aria-label="Direct link to Step 1: Prerequisites" title="Direct link to Step 1: Prerequisites">​</a></h3>
<ul>
<li>
<p><strong>Deploy DoD Certificates</strong>
Ensure all devices have the necessary DoD root and intermediate certificates installed. Follow the official guide here: <a href="/docs/certificate/DoD-Certificates-Admins">DoD Certificates Installation Guide</a>.</p>
</li>
<li>
<p><strong>Establish a CAC Pairing Workflow</strong>
We recommend the <strong>Pair PIV ID</strong> method. This approach is ideal for deployment as it:</p>
<ul>
<li>Can be pushed out centrally with minimal user interaction</li>
<li>Supports CAC replacement and multiple CACs per user</li>
<li>Offers long-term reliability with fewer re-pairing needs</li>
</ul>
</li>
<li>
<p><strong>Verify CAC Pairing</strong>
Before enabling CAC enforcement, confirm that each user has a valid CAC pairing in place.</p>
</li>
</ul>
<p><strong>Automation Script</strong>
Use the following script to automatically verify CAC pairing status across user accounts:</p>
<p>🔗 <a href="https://github.com/cocopuff2u/CAC_FOR_MAC/blob/main/scripts/SmartCard_Verify.zsh" target="_blank" rel="noopener noreferrer"><strong>SmartCard_Verify</strong></a>
This script checks for valid CAC pairing by verifying the presence of the mapped PIV ID and related configuration settings.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="step-2-create-a-smart-card-enforcement-profile">Step 2. Create a Smart Card Enforcement Profile<a href="#step-2-create-a-smart-card-enforcement-profile" class="hash-link" aria-label="Direct link to Step 2. Create a Smart Card Enforcement Profile" title="Direct link to Step 2. Create a Smart Card Enforcement Profile">​</a></h3>
<p>To enable CAC (Common Access Card) authentication, you’ll need to configure the <code>com.apple.security.smartcard</code> policy on managed devices. This is typically done by deploying either a configuration profile (<code>.mobileconfig</code>) or a property list (<code>.plist</code>) via your MDM solution.</p>
<p>Below, you’ll find example configurations with detailed explanations for each key. Customize the settings to suit your organization&#x27;s requirements.</p>
<p>For comprehensive details, refer to the <a href="https://developer.apple.com/documentation/devicemanagement/smartcard" target="_blank" rel="noopener noreferrer">Apple Smart Card Payload Documentation</a> and <a href="https://support.apple.com/guide/deployment/advanced-smart-card-options-dep7b2ede1e3/web" target="_blank" rel="noopener noreferrer">Advanced Smart Card Options</a>.</p>
<p>💡 <strong>Need a quick way to generate a custom profile?</strong>
Use the guided script below to create a tailored configuration profile:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sudo bash -c &quot;$(curl -s https://raw.githubusercontent.com/cocopuff2u/CAC_FOR_MAC/refs/heads/main/automated_scripts/generate_smartcard_mobileconfig.sh)&quot;</span><br></span></code></pre></div></div>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>warning</div><div class="admonitionContent_BuS1"><p>Anytime you run any scripts, it is recommended to review the code beforehand to verify it is not doing anything outside the described steps. You can inspect this one <a href="https://raw.githubusercontent.com/cocopuff2u/CAC_FOR_MAC/refs/heads/main/automated_scripts/generate_smartcard_mobileconfig.sh" target="_blank" rel="noopener noreferrer">here</a></p></div></div>
<div class="tabs-container tabList__CuJ"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_LNqP tabs__item--active">Example .mobileconfig</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP">Example .plist</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_Ymn6"><div class="language-xml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-xml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">&lt;!-- Example: Smart Card Enforcement.mobileconfig --&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token prolog" style="color:#999988;font-style:italic">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token doctype punctuation" style="color:#393A34;font-style:italic">&lt;!</span><span class="token doctype doctype-tag" style="color:#999988;font-style:italic">DOCTYPE</span><span class="token doctype" style="color:#999988;font-style:italic"> </span><span class="token doctype name" style="color:#999988;font-style:italic">plist</span><span class="token doctype" style="color:#999988;font-style:italic"> </span><span class="token doctype name" style="color:#999988;font-style:italic">PUBLIC</span><span class="token doctype" style="color:#999988;font-style:italic"> </span><span class="token doctype string" style="color:#e3116c;font-style:italic">&quot;-//Apple//DTD PLIST 1.0//EN&quot;</span><span class="token doctype" style="color:#999988;font-style:italic"> </span><span class="token doctype string" style="color:#e3116c;font-style:italic">&quot;http://www.apple.com/DTDs/PropertyList-1.0.dtd&quot;</span><span class="token doctype punctuation" style="color:#393A34;font-style:italic">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">plist</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">version</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">1.0</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dict</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">key</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">PayloadContent</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">key</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">array</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dict</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">&lt;!-- PayloadDescription: Optional description for this payload --&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">key</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">PayloadDescription</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">key</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">string</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">string</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">&lt;!-- PayloadDisplayName: Name shown in Profiles UI --&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">key</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">PayloadDisplayName</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">key</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">string</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">SmartCard</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">string</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">&lt;!-- PayloadEnabled: Whether this payload is enabled --&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">key</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">PayloadEnabled</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">key</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">true</span><span class="token tag punctuation" style="color:#393A34">/&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">&lt;!-- PayloadIdentifier: Unique identifier for this payload --&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">key</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">PayloadIdentifier</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">key</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">string</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">com.cac-for-mac.smartcard.enforcement</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">string</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">&lt;!-- PayloadType: Must be com.apple.security.smartcard for smart card enforcement --&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">key</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">PayloadType</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">key</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">string</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">com.apple.security.smartcard</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">string</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">&lt;!-- PayloadUUID: Unique UUID for this payload --&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">key</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">PayloadUUID</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">key</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">string</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">6A2F1B3C-9D4E-4A1B-8C2F-1234567890AB</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">string</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">&lt;!-- PayloadVersion: Version number for this payload --&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">key</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">PayloadVersion</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">key</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">integer</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">1</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">integer</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">&lt;!-- </span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">        UserPairing (boolean): </span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">        If false, users don’t get the pairing dialog, although existing pairings still work.</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">        Default: true</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">      --&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">key</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">UserPairing</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">key</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">false</span><span class="token tag punctuation" style="color:#393A34">/&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">&lt;!-- </span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">        allowSmartCard (boolean): </span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">        If false, disables the SmartCard for logins, authorizations, and screen saver unlocking. </span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">        Still allowed for other functions, such as signing emails and accessing the web. </span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">        Restart required for changes. </span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">        Default: true</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">      --&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">key</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">allowSmartCard</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">key</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">true</span><span class="token tag punctuation" style="color:#393A34">/&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">&lt;!-- </span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">        checkCertificateTrust (integer): </span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">        Configures the certificate trust check.</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">        0: Off</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">        1: Standard validity check (no revocation)</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">        2: Soft revocation check (default: valid unless explicitly revoked)</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">        3: Hard revocation check (default: invalid unless explicitly OK)</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">        Default: 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">      --&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">key</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">checkCertificateTrust</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">key</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">integer</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">2</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">integer</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">&lt;!-- </span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">        oneCardPerUser (boolean): </span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">        If true, a user can pair with only one SmartCard, although existing pairings are allowed if already set up.</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">        Default: false</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">      --&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">key</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">oneCardPerUser</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">key</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">false</span><span class="token tag punctuation" style="color:#393A34">/&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">&lt;!-- </span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">        enforceSmartCard (boolean): </span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">        If true, a user can only log in or authenticate with a SmartCard.</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">        Available in macOS 10.13.2 and later.</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">        Default: false</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">      --&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">key</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">enforceSmartCard</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">key</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">true</span><span class="token tag punctuation" style="color:#393A34">/&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">&lt;!-- </span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">        allowUnmappedUsers (integer): </span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">        1 = allow users not mapped to a smart card, 0 = disallow</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">      --&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">key</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">allowUnmappedUsers</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">key</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">integer</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">1</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">integer</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">&lt;!-- </span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">        tokenRemovalAction (integer): </span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">        If 1, the system enables the screen saver when the SmartCard is removed.</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">        Available in macOS 10.13.4 and later.</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">        Default: 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">        Possible Values: 0, 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">      --&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">&lt;!-- &lt;key&gt;tokenRemovalAction&lt;/key&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">      &lt;integer&gt;1&lt;/integer&gt; --&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dict</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">array</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">&lt;!-- PayloadDescription: Description for the overall profile --&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">key</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">PayloadDescription</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">key</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">string</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">Settings for Smartcard Enforcement</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">string</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">&lt;!-- PayloadDisplayName: Name for the overall profile --&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">key</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">PayloadDisplayName</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">key</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">string</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">Smartcard Enforcement</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">string</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">&lt;!-- PayloadEnabled: Whether the profile is enabled --&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">key</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">PayloadEnabled</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">key</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">true</span><span class="token tag punctuation" style="color:#393A34">/&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">&lt;!-- PayloadIdentifier: Unique identifier for the profile --&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">key</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">PayloadIdentifier</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">key</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">string</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">com.cac-for-mac.smartcard.profile.1B2C3D4E-5F6A-7B8C-9D0E-ABCDEF123456</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">string</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">&lt;!-- PayloadOrganization: Organization name --&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">key</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">PayloadOrganization</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">key</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">string</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">Your Organization</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">string</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">&lt;!-- PayloadRemovalDisallowed: If true, prevents removal of the profile --&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">key</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">PayloadRemovalDisallowed</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">key</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">true</span><span class="token tag punctuation" style="color:#393A34">/&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">&lt;!-- PayloadScope: System = applies to all users --&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">key</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">PayloadScope</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">key</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">string</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">System</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">string</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">&lt;!-- PayloadType: Configuration profile type --&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">key</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">PayloadType</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">key</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">string</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">Configuration</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">string</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">&lt;!-- PayloadUUID: Unique UUID for the profile --&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">key</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">PayloadUUID</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">key</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">string</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">1B2C3D4E-5F6A-7B8C-9D0E-ABCDEF123456</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">string</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">&lt;!-- PayloadVersion: Version number for the profile --&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">key</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">PayloadVersion</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">key</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">integer</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">1</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">integer</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dict</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">plist</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><br></span></code></pre></div></div></div><div role="tabpanel" class="tabItem_Ymn6" hidden=""><div class="language-xml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-xml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">&lt;!-- Example: /Library/Preferences/com.apple.security.smartcard.plist --&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token prolog" style="color:#999988;font-style:italic">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token doctype punctuation" style="color:#393A34;font-style:italic">&lt;!</span><span class="token doctype doctype-tag" style="color:#999988;font-style:italic">DOCTYPE</span><span class="token doctype" style="color:#999988;font-style:italic"> </span><span class="token doctype name" style="color:#999988;font-style:italic">plist</span><span class="token doctype" style="color:#999988;font-style:italic"> </span><span class="token doctype name" style="color:#999988;font-style:italic">PUBLIC</span><span class="token doctype" style="color:#999988;font-style:italic"> </span><span class="token doctype string" style="color:#e3116c;font-style:italic">&quot;-//Apple//DTD PLIST 1.0//EN&quot;</span><span class="token doctype" style="color:#999988;font-style:italic"> </span><span class="token doctype string" style="color:#e3116c;font-style:italic">&quot;http://www.apple.com/DTDs/PropertyList-1.0.dtd&quot;</span><span class="token doctype punctuation" style="color:#393A34;font-style:italic">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">plist</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">version</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">1.0</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dict</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">&lt;!-- </span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">    UserPairing (boolean): </span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">    If false, users don’t get the pairing dialog, although existing pairings still work.</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">    Default: true</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">  --&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">key</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">UserPairing</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">key</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">false</span><span class="token tag punctuation" style="color:#393A34">/&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">&lt;!-- </span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">    allowSmartCard (boolean): </span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">    If false, disables the SmartCard for logins, authorizations, and screen saver unlocking. </span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">    Still allowed for other functions, such as signing emails and accessing the web. </span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">    Restart required for changes. </span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">    Default: true</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">  --&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">key</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">allowSmartCard</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">key</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">true</span><span class="token tag punctuation" style="color:#393A34">/&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">&lt;!-- </span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">    checkCertificateTrust (integer): </span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">    Configures the certificate trust check.</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">    0: Off</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">    1: Standard validity check (no revocation)</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">    2: Soft revocation check (default: valid unless explicitly revoked)</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">    3: Hard revocation check (default: invalid unless explicitly OK)</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">    Default: 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">  --&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">key</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">checkCertificateTrust</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">key</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">integer</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">2</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">integer</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">&lt;!-- </span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">    oneCardPerUser (boolean): </span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">    If true, a user can pair with only one SmartCard, although existing pairings are allowed if already set up.</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">    Default: false</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">  --&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">key</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">oneCardPerUser</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">key</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">false</span><span class="token tag punctuation" style="color:#393A34">/&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">&lt;!-- </span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">    enforceSmartCard (boolean): </span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">    If true, a user can only log in or authenticate with a SmartCard.</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">    Available in macOS 10.13.2 and later.</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">    Default: false</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">  --&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">key</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">enforceSmartCard</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">key</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">true</span><span class="token tag punctuation" style="color:#393A34">/&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">&lt;!-- </span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">    allowUnmappedUsers (integer): </span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">    1 = allow users not mapped to a smart card, 0 = disallow</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">  --&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">key</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">allowUnmappedUsers</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">key</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">integer</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">1</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">integer</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">&lt;!-- </span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">    tokenRemovalAction (integer): </span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">    If 1, the system enables the screen saver when the SmartCard is removed.</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">    Available in macOS 10.13.4 and later.</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">    Default: 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">    Possible Values: 0, 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">  --&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">&lt;!-- &lt;key&gt;tokenRemovalAction&lt;/key&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">  &lt;integer&gt;1&lt;/integer&gt; --&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dict</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">plist</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><br></span></code></pre></div></div></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="step-3-update-pam-configuration">Step 3. Update PAM Configuration<a href="#step-3-update-pam-configuration" class="hash-link" aria-label="Direct link to Step 3. Update PAM Configuration" title="Direct link to Step 3. Update PAM Configuration">​</a></h3>
<p>To enable CAC authentication for system functions such as <code>sudo</code>, <code>login</code>, and <code>su</code>, you must update the relevant PAM (Pluggable Authentication Modules) configuration files. Below are two scripts: one that enables CAC authentication (recommended for CAC-enforced environments), and the default configuration for reference.</p>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>warning</div><div class="admonitionContent_BuS1"><p>Modifying PAM configuration files can impact authentication and potentially prevent logins or sudo access if misconfigured. Test these changes thoroughly on a small group of devices before deploying to your entire fleet.</p></div></div>
<div class="tabs-container tabList__CuJ"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_LNqP tabs__item--active">CAC-Enabled PAM (Recommended)</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP">Default PAM (macOS)</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_Ymn6"><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">#!/bin/bash</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># This script configures PAM to support CAC authentication for sudo, login, and su.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Write a new sudo PAM file to require CAC (pam_smartcard.so) for sudo access.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cat &gt; /etc/pam.d/sudo &lt;&lt; SUDO_END</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># sudo: auth account password session</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">auth        sufficient    pam_smartcard.so      # Allow CAC authentication</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">auth        required      pam_opendirectory.so  # Fallback to local directory</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">auth        required      pam_deny.so           # Deny if above fail</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">account     required      pam_permit.so</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">password    required      pam_deny.so</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">session     required      pam_permit.so</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">SUDO_END</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">chmod 444 /etc/pam.d/sudo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">chown root:wheel /etc/pam.d/sudo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Write a new login PAM file to support CAC and other authentication methods.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cat &gt; /etc/pam.d/login &lt;&lt; LOGIN_END</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># login: auth account password session</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">auth        sufficient    pam_smartcard.so      # Allow CAC authentication</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">auth        optional      pam_krb5.so use_kcminit</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">auth        optional      pam_ntlm.so try_first_pass</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">auth        optional      pam_mount.so try_first_pass</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">auth        required      pam_opendirectory.so try_first_pass</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">auth        required      pam_deny.so</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">account     required      pam_nologin.so</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">account     required      pam_opendirectory.so</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">password    required      pam_opendirectory.so</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">session     required      pam_launchd.so</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">session     required      pam_uwtmp.so</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">session     optional      pam_mount.so</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">LOGIN_END</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">chmod 644 /etc/pam.d/login</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">chown root:wheel /etc/pam.d/login</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Write a new su PAM file to require CAC for su access.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cat &gt; /etc/pam.d/su &lt;&lt; SU_END</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># su: auth account password session</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">auth        sufficient    pam_smartcard.so      # Allow CAC authentication</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">auth        required      pam_rootok.so</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">auth        required      pam_group.so no_warn group=admin,wheel ruser root_only fail_safe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">account     required      pam_permit.so</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">account     required      pam_opendirectory.so no_check_shell</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">password    required      pam_opendirectory.so</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">session     required      pam_launchd.so</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">SU_END</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">chmod 644 /etc/pam.d/su</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">chown root:wheel /etc/pam.d/su</span><br></span></code></pre></div></div></div><div role="tabpanel" class="tabItem_Ymn6" hidden=""><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">#!/bin/bash</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># This script restores the default macOS PAM configuration for sudo, login, and su.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Default sudo PAM file (no CAC)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cat &gt; /etc/pam.d/sudo &lt;&lt; SUDO_END</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># sudo: auth account password session</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">auth       sufficient     pam_smartcard.so</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">auth       required       pam_opendirectory.so</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">account    required       pam_permit.so</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">password   required       pam_deny.so</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">session    required       pam_permit.so</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">SUDO_END</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">chmod 444 /etc/pam.d/sudo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">chown root:wheel /etc/pam.d/sudo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Default login PAM file</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cat &gt; /etc/pam.d/login &lt;&lt; LOGIN_END</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># login: auth account password session</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">auth       optional       pam_krb5.so use_kcminit</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">auth       optional       pam_ntlm.so try_first_pass</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">auth       optional       pam_mount.so try_first_pass</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">auth       required       pam_opendirectory.so try_first_pass</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">account    required       pam_nologin.so</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">account    required       pam_opendirectory.so</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">password   required       pam_opendirectory.so</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">session    required       pam_launchd.so</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">session    required       pam_uwtmp.so</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">session    optional       pam_mount.so</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">LOGIN_END</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">chmod 644 /etc/pam.d/login</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">chown root:wheel /etc/pam.d/login</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Default su PAM file</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cat &gt; /etc/pam.d/su &lt;&lt; SU_END</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># su: auth account session</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">auth       sufficient     pam_rootok.so</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">auth       required       pam_opendirectory.so</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">account    required       pam_group.so no_warn group=admin,wheel ruser root_only fail_safe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">account    required       pam_opendirectory.so no_check_shell</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">password   required       pam_opendirectory.so</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">session    required       pam_launchd.so</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">SU_END</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">chmod 644 /etc/pam.d/su</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">chown root:wheel /etc/pam.d/su</span><br></span></code></pre></div></div></div></div></div>
<p><strong>What does this script do?</strong></p>
<ul>
<li><strong>sudo</strong>: Adds <code>pam_smartcard.so</code> as sufficient, allowing CAC authentication for sudo. If CAC is not present, falls back to local directory authentication.</li>
<li><strong>login</strong>: Adds <code>pam_smartcard.so</code> as sufficient, enabling CAC authentication at login. Other modules (Kerberos, NTLM, etc.) remain optional or required as fallback.</li>
<li><strong>su</strong>: Adds <code>pam_smartcard.so</code> as sufficient, allowing CAC authentication for switching users (su). Other checks (root, group, etc.) remain enforced.</li>
<li><strong>Permissions</strong>: Sets correct permissions and ownership for each PAM file to ensure system security.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="step-4-upload-smart-card-configuration-files">Step 4. Upload Smart Card Configuration Files<a href="#step-4-upload-smart-card-configuration-files" class="hash-link" aria-label="Direct link to Step 4. Upload Smart Card Configuration Files" title="Direct link to Step 4. Upload Smart Card Configuration Files">​</a></h3>
<p>To deploy CAC enforcement, upload the <code>.mobileconfig</code>, <code>.plist</code>, and any related scripts to your MDM solution. It is also recommended to upload uninstall scripts and ensure exempt accounts are set up.</p>
<p>Below are guides for uploading configuration profiles and scripts with popular MDMs:</p>
<ul>
<li><a href="https://learn.jamf.com/en-US/bundle/jamf-pro-documentation-current/page/Computer_Configuration_Profiles.html#ariaid-title5" target="_blank" rel="noopener noreferrer">Jamf Pro: Uploading and Deploying Configuration Profiles</a></li>
<li><a href="https://learn.jamf.com/en-US/bundle/jamf-pro-documentation-current/page/Scripts.html" target="_blank" rel="noopener noreferrer">Jamf Pro: Deploying Scripts</a></li>
<li><a href="https://support.kandji.io/kb/custom-profiles-overview" target="_blank" rel="noopener noreferrer">Kandji: Uploading Custom Profiles</a></li>
<li><a href="https://support.kandji.io/kb/custom-scripts-overview" target="_blank" rel="noopener noreferrer">Kandji: Custom Scripts</a></li>
<li><a href="https://learn.microsoft.com/en-us/intune/intune-service/configuration/custom-settings-macos" target="_blank" rel="noopener noreferrer">Intune: Add or Create Configuration Profiles</a></li>
<li><a href="https://learn.microsoft.com/en-us/intune/intune-service/apps/macos-shell-scripts" target="_blank" rel="noopener noreferrer">Intune: Deploy Scripts</a></li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="step-5-enforce-smart-card-policies">Step 5. Enforce Smart Card Policies<a href="#step-5-enforce-smart-card-policies" class="hash-link" aria-label="Direct link to Step 5. Enforce Smart Card Policies" title="Direct link to Step 5. Enforce Smart Card Policies">​</a></h3>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>warning</div><div class="admonitionContent_BuS1"><p>Before enforcing smart card policies, ensure every user has a CAC paired with their account <strong>or</strong> that you have an <a href="#create-the-exempt-group-and-add-a-user">exempt admin account available</a>. Failing to do so may result in being locked out of the device.</p></div></div>
<ul>
<li>Assign the smart card enforcement profile (<code>.mobileconfig</code> or <code>.plist</code>) to the appropriate device groups or users in your MDM.</li>
<li>Deploy the profile to all targeted devices.</li>
</ul>
<p>Thoroughly test this configuration on a small set of devices before expanding deployment to your entire fleet. Confirm that CAC enforcement is working as intended and that users can access their accounts without issue.</p>
<p>Once you have validated successful CAC enforcement and user access, you can safely deploy the PAM configuration script (see Step 3) to enable CAC authentication for additional system functions such as <code>sudo</code>, <code>login</code>, and <code>su</code>.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="step-6-verify-functionality">Step 6. Verify Functionality<a href="#step-6-verify-functionality" class="hash-link" aria-label="Direct link to Step 6. Verify Functionality" title="Direct link to Step 6. Verify Functionality">​</a></h3>
<p>After deploying the smart card enforcement profile and updating PAM configuration, thoroughly verify that CAC authentication is functioning as intended across all targeted system functions.</p>
<ul>
<li>Test login, sudo, and su operations with a CAC on several devices.</li>
<li>Confirm that users without a paired CAC or those not in the exempt group are unable to authenticate.</li>
<li>Ensure that exempt admin/service accounts can still access the system as intended.</li>
<li>Check for any unexpected lockouts or authentication issues and resolve them before proceeding with a wider deployment.</li>
</ul>
<p>If any issues are detected, use your exempt account to regain access and adjust your configuration or policies as needed.</p>
<div class="theme-admonition theme-admonition-important admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>important</div><div class="admonitionContent_BuS1"><p>If you are required to comply with DISA STIGs or other local security policies, you may need to further adjust certain settings or smart card enforcement options to meet those requirements. Review your organization&#x27;s compliance documentation and test accordingly.</p></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="step-7-test-test-test">Step 7. Test, Test, Test<a href="#step-7-test-test-test" class="hash-link" aria-label="Direct link to Step 7. Test, Test, Test" title="Direct link to Step 7. Test, Test, Test">​</a></h3>
<p>Smart card enforcement—especially when combined with compliance requirements—demands extensive testing. Some authentication functions or workflows may not work as expected depending on your complete setup, including:</p>
<ul>
<li>The method used for CAC pairing</li>
<li>The deployment and trust of DoD certificates</li>
<li>The specific compliance benchmarks or security policies (e.g., DISA STIGs) you must meet</li>
</ul>
<p>Test all critical user and admin workflows, including login, sudo, su, and any other authentication-dependent processes. Validate that your configuration meets both operational and compliance requirements before deploying at scale.</p>
<p>Here’s a clearer and more polished version of your content. The technical meaning is preserved, but the tone and flow are improved for better readability and professionalism:</p>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="cac-exemption"><strong>CAC Exemption</strong><a href="#cac-exemption" class="hash-link" aria-label="Direct link to cac-exemption" title="Direct link to cac-exemption">​</a></h2>
<div class="theme-admonition theme-admonition-important admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>important</div><div class="admonitionContent_BuS1"><p><em>Exempting users from CAC enforcement should be limited to administrative or service accounts. These exemptions serve as a contingency for troubleshooting or recovery in the event of a lockout. For standard users, it is more secure to remove the enforcement policy via MDM instead of manually adding them to the exemption group. This approach helps maintain a stronger overall security posture and reduces unnecessary exceptions.</em></p><p><strong>Security Best Practice:</strong><br>
<em>Accounts placed in the exempt group—especially admin or service accounts—should include additional safeguards such as:</em></p><ul>
<li>
<p><em>A disabled or expired (&quot;dead&quot;) password</em></p>
</li>
<li>
<p><em>Frequent password rotation</em></p>
</li>
<li>
<p><em>Limited privileges (e.g., demoting to standard user unless admin rights are strictly necessary)</em></p>
</li>
</ul><p><em>These measures help prevent exempted accounts from being exploited as a backdoor to bypass CAC authentication.</em></p></div></div>
<p>If you used the <a href="https://github.com/cocopuff2u/CAC_FOR_MAC/blob/main/scripts/SmartCard_Mapping.sh" target="_blank" rel="noopener noreferrer">SmartCard Mapping script</a> <strong>without</strong> the exemption workflow, or the user manually paired the CAC, the <code>EXEMPT_GROUP</code> may not be present. In this case, you’ll need to configure exemptions manually by creating the <code>/private/etc/SmartCardLogin.plist</code> file, following <a href="https://support.apple.com/guide/deployment/configure-a-mac-smart-cardonly-authentication-depfce8de48b/web" target="_blank" rel="noopener noreferrer">Apple’s official guidance</a>, or by using the script below.</p>
<p>For a streamlined process, you can also use the <a href="https://github.com/cocopuff2u/CAC_FOR_MAC/blob/main/scripts/SmartCard_Mapping_With_Exempt.sh" target="_blank" rel="noopener noreferrer">SmartCard Mapping with Exempt Script</a>, which automatically:</p>
<ul>
<li>Creates the exemption group</li>
<li>Adds the user</li>
<li>Maps their PIV certificate</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="create-smartcardloginplist">Create <code>SmartCardLogin.plist</code><a href="#create-smartcardloginplist" class="hash-link" aria-label="Direct link to create-smartcardloginplist" title="Direct link to create-smartcardloginplist">​</a></h3>
<p>Use this script to generate the required <code>SmartCardLogin.plist</code> file:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">#!/bin/bash</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PLIST_PATH=&quot;/private/etc/SmartCardLogin.plist&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo tee &quot;$PLIST_PATH&quot; &gt; /dev/null &lt;&lt;&#x27;EOF&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;!DOCTYPE plist PUBLIC &quot;-//Apple//DTD PLIST 1.0//EN&quot; &quot;http://www.apple.com/DTDs/PropertyList-1.0.dtd&quot;&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;plist version=&quot;1.0&quot;&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;dict&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;key&gt;AttributeMapping&lt;/key&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;dict&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &lt;key&gt;dsAttributeString&lt;/key&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &lt;string&gt;dsAttrTypeStandard:AltSecurityIdentities&lt;/string&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &lt;key&gt;fields&lt;/key&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &lt;array&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &lt;string&gt;NT Principal Name&lt;/string&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &lt;/array&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &lt;key&gt;formatString&lt;/key&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &lt;string&gt;Kerberos:\$1&lt;/string&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;/dict&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;key&gt;TrustedAuthorities&lt;/key&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;array&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &lt;string&gt;SHA256_HASH_OF_CERTDOMAIN_1&lt;/string&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &lt;string&gt;SHA256_HASH_OF_CERTDOMAIN_2&lt;/string&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;/array&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;key&gt;NotEnforcedGroup&lt;/key&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;string&gt;EXEMPT_GROUP&lt;/string&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;/dict&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;/plist&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">EOF</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo chown root:wheel &quot;$PLIST_PATH&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo chmod 644 &quot;$PLIST_PATH&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo &quot;✅ SmartCardLogin.plist created successfully at $PLIST_PATH&quot;</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="create-the-exempt-group-and-add-a-user">Create the Exempt Group and Add a User<a href="#create-the-exempt-group-and-add-a-user" class="hash-link" aria-label="Direct link to Create the Exempt Group and Add a User" title="Direct link to Create the Exempt Group and Add a User">​</a></h3>
<p>To manually create the exemption group and assign a user to it, use the following:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">#!/bin/bash</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">EXEMPT_USER=&quot;EXEMPT_USER&quot;   # &lt;-- Replace with the username to exempt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">EXEMPT_GROUP=&quot;EXEMPT_GROUP&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Create the group if it doesn&#x27;t already exist</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">if ! dscl . -read /Groups/&quot;$EXEMPT_GROUP&quot; &amp;&gt;/dev/null; then</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    sudo dscl . -create /Groups/&quot;$EXEMPT_GROUP&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    sudo dscl . -create /Groups/&quot;$EXEMPT_GROUP&quot; RealName &quot;CAC Exempt Users&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    sudo dscl . -create /Groups/&quot;$EXEMPT_GROUP&quot; passwd &quot;*&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    sudo dscl . -create /Groups/&quot;$EXEMPT_GROUP&quot; gid &quot;600&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fi</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Add the user to the group</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo dseditgroup -o edit -a &quot;$EXEMPT_USER&quot; -t user &quot;$EXEMPT_GROUP&quot;</span><br></span></code></pre></div></div>
<p><strong>Usage Tips:</strong></p>
<ul>
<li>Replace <code>EXEMPT_USER</code> with the actual username to be exempted.</li>
<li>This script will create the group if it does not already exist and add the user to it.</li>
<li>Anyone user in that group will be exempt from CAC enforcement</li>
</ul>
<p><strong>Recommendation:</strong>
Whenever possible, use the <a href="https://github.com/cocopuff2u/CAC_FOR_MAC/blob/main/scripts/SmartCard_Mapping_With_Exempt.sh" target="_blank" rel="noopener noreferrer">SmartCard Mapping with Exempt Script</a> to simplify the process and reduce manual errors.</p>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="uninstall-pam-configuration"><strong>Uninstall PAM Configuration</strong><a href="#uninstall-pam-configuration" class="hash-link" aria-label="Direct link to uninstall-pam-configuration" title="Direct link to uninstall-pam-configuration">​</a></h2>
<p>To revert the PAM configuration to the macOS defaults (removing CAC enforcement for <code>sudo</code>, <code>login</code>, and <code>su</code>), use the following script:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">#!/bin/bash</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># This script restores the default macOS PAM configuration for sudo, login, and su.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Default sudo PAM file (no CAC)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cat &gt; /etc/pam.d/sudo &lt;&lt; SUDO_END</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># sudo: auth account password session</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">auth       sufficient     pam_smartcard.so</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">auth       required       pam_opendirectory.so</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">account    required       pam_permit.so</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">password   required       pam_deny.so</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">session    required       pam_permit.so</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">SUDO_END</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">chmod 444 /etc/pam.d/sudo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">chown root:wheel /etc/pam.d/sudo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Default login PAM file</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cat &gt; /etc/pam.d/login &lt;&lt; LOGIN_END</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># login: auth account password session</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">auth       optional       pam_krb5.so use_kcminit</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">auth       optional       pam_ntlm.so try_first_pass</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">auth       optional       pam_mount.so try_first_pass</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">auth       required       pam_opendirectory.so try_first_pass</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">account    required       pam_nologin.so</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">account    required       pam_opendirectory.so</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">password   required       pam_opendirectory.so</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">session    required       pam_launchd.so</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">session    required       pam_uwtmp.so</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">session    optional       pam_mount.so</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">LOGIN_END</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">chmod 644 /etc/pam.d/login</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">chown root:wheel /etc/pam.d/login</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Default su PAM file</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cat &gt; /etc/pam.d/su &lt;&lt; SU_END</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># su: auth account session</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">auth       sufficient     pam_rootok.so</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">auth       required       pam_opendirectory.so</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">account    required       pam_group.so no_warn group=admin,wheel ruser root_only fail_safe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">account    required       pam_opendirectory.so no_check_shell</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">password   required       pam_opendirectory.so</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">session    required       pam_launchd.so</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">SU_END</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">chmod 644 /etc/pam.d/su</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">chown root:wheel /etc/pam.d/su</span><br></span></code></pre></div></div>
<p>This will restore the default PAM configuration for the main authentication functions.</p>
<small><div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>Feedback?</div><div class="admonitionContent_BuS1"><p><em>If you found an error, noticed something missing, or need additional help, please <a href="https://github.com/cocopuff2u/CAC_FOR_MAC/issues" target="_blank" rel="noopener noreferrer">submit feedback on GitHub</a> or start a <a href="https://github.com/cocopuff2u/CAC_FOR_MAC/discussions" target="_blank" rel="noopener noreferrer">GitHub discussion</a>.</em></p><p><em>If you&#x27;d like to contribute improvements to this guide, feel free to submit a <a href="https://github.com/cocopuff2u/CAC_FOR_MAC/pulls" target="_blank" rel="noopener noreferrer">pull request</a> or select <code>edit this page</code> below.</em></p></div></div></small></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/Cocopuff2u/CAC_FOR_MAC/edit/main/my-website/docs/smartcard/DoD-SmartCard-Admins.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/smartcard/DoD-SmartCard-Users"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">DoD | User</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/smartcard/SmartCard-Settings"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">SmartCard Settings</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#cac-workflow" class="table-of-contents__link toc-highlight"><strong>CAC Workflow</strong></a></li><li><a href="#cac-pairing" class="table-of-contents__link toc-highlight"><strong>CAC Pairing</strong></a><ul><li><a href="#pair-piv-id-preferred-method" class="table-of-contents__link toc-highlight">Pair PIV ID <small><em>(Preferred Method)</em></small></a></li><li><a href="#built-in-pairing" class="table-of-contents__link toc-highlight">Built-In Pairing</a></li></ul></li><li><a href="#cac-enforcement" class="table-of-contents__link toc-highlight"><strong>CAC Enforcement</strong></a><ul><li><a href="#step-1-prerequisites" class="table-of-contents__link toc-highlight">Step 1: Prerequisites</a></li><li><a href="#step-2-create-a-smart-card-enforcement-profile" class="table-of-contents__link toc-highlight">Step 2. Create a Smart Card Enforcement Profile</a></li><li><a href="#step-3-update-pam-configuration" class="table-of-contents__link toc-highlight">Step 3. Update PAM Configuration</a></li><li><a href="#step-4-upload-smart-card-configuration-files" class="table-of-contents__link toc-highlight">Step 4. Upload Smart Card Configuration Files</a></li><li><a href="#step-5-enforce-smart-card-policies" class="table-of-contents__link toc-highlight">Step 5. Enforce Smart Card Policies</a></li><li><a href="#step-6-verify-functionality" class="table-of-contents__link toc-highlight">Step 6. Verify Functionality</a></li><li><a href="#step-7-test-test-test" class="table-of-contents__link toc-highlight">Step 7. Test, Test, Test</a></li></ul></li><li><a href="#cac-exemption" class="table-of-contents__link toc-highlight"><strong>CAC Exemption</strong></a><ul><li><a href="#create-smartcardloginplist" class="table-of-contents__link toc-highlight">Create <code>SmartCardLogin.plist</code></a></li><li><a href="#create-the-exempt-group-and-add-a-user" class="table-of-contents__link toc-highlight">Create the Exempt Group and Add a User</a></li></ul></li><li><a href="#uninstall-pam-configuration" class="table-of-contents__link toc-highlight"><strong>Uninstall PAM Configuration</strong></a></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/intro">Introduction</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/certificate/Certificate-Introduction">Certificate Guide</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/smartcard/Smart-Card-Introduction">Smart Card Guide</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://macadmins.slack.com/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Mac Admins Slack<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/cocopuff2u/CAC_FOR_MAC" target="_blank" rel="noopener noreferrer" class="footer__link-item">CaC For Mac GitHub<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://github.com/cocopuff2u/CAC_FOR_MAC/issues" target="_blank" rel="noopener noreferrer" class="footer__link-item">Found an Issue?<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://github.com/cocopuff2u/CAC_FOR_MAC/discussions" target="_blank" rel="noopener noreferrer" class="footer__link-item">Need Something?<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 CAC For Mac.</div></div></div></footer></div>
</body>
</html>